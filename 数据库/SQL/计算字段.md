# 创建计算字段

## 计算字段

存储在表里的数据都不是应用程序所需要的，需要直接从数据库中检索出转换、计算或格式化的数据，而不是检索出数据，然后在客户端应用程序进行格式化。

> 字段(field)：基本上与列相同，经常互换使用。不过数据库列一般称为列，而字段这个属于通常在计算字段场合使用。

只有数据库知道`SELECT`语句中哪些列是实际的表列，哪些列是计算字段。丛客户端来看，计算字段的数据和其他列的数据返回方式相同。

## 拼接字段

> 拼接：将值联结到一起（将一个值附加到另外一个值上）构成单个值。

客户端需要输出一个`列名1`和`列名2`组合而成的信息，且`列名2`需要用括号括起来。

`SQL Server`中

    SELECT 列名1 + '('+ 列名2 +')'
    FROM 表名
    ORDER BY 列名1;

`DB2`，`Oracle`，`SQlite`中

    SELECT 列名1 || '('|| 列名2 ||')'
    FROM 表名
    ORDER BY 列名1;

不同的数据库软件可能使用`+`或者`||`来实现拼接，效果其实一样。

`MySQL`或者`MariaDB`

    SELECT Concat(列名1,'(',列名2,')')
    FROM 表名
    ORDER BY 列名1;

最终的输出，结合成一个计算字段的两个列中间用空格填充，要去掉这些空格，可以使用`SQL`的`RTRIM()`函数来完成。

    SELECT RTRIM(列名1) + '('+ RTRIM(列名2) +')'
    FROM 表名
    ORDER BY 列名1;

    SELECT RTRIM(列名1) || '('|| RTRIM(列名2) ||')'
    FROM 表名
    ORDER BY 列名1;
    
    SELECT Concat(RTrim(列名1),'(',RTrim(列名2),')')
    FROM 表名
    ORDER BY 列名1;

`RTRIM()`函数去掉值右边的所有空格。`LTRIM()`去掉字符串左边的空格。`TRIM()`去掉字符串左右两边的空格。

### 使用别名

通过拼接字段得出的新的列只是一个值，并没有名字，但是没有名字的列不能应用于客户端应用中，客户端无法引用。`SQL`支持列别名，使用`AS`关键字

    SELECT RTRIM(列名1) + '('+ RTRIM(列名2) +')'
    AS 列名x
    FROM 表名
    ORDER BY 列名1;

    SELECT RTRIM(列名1) || '('|| RTRIM(列名2) ||')'
    AS 列名x
    FROM 表名
    ORDER BY 列名1;

    SELECT Concat(RTrim(列名1),'(',RTrim(列名2),')')
    AS 列名x
    FROM 表名
    ORDER BY 列名1;

`AS`指示`SQL`创建一个包含指定计算结果的名为`列名x`的计算字段。

## 执行算数计算

对检索出来的数据进行算术计算

    SELECT 列名1,
           列名2,
           列名3,
           列名2*列名3 AS 列名5
    FROM 表名
    WHERE 列名4 = 20008;

其中`列名5`列是一个计算字段，计算值为`列名2`*`列名3`