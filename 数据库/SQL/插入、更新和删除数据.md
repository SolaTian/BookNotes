# 插入数据

## 数据插入

`INSERT`用来将行插入（或添加）到数据库表中。

### 插入完整的行

    INSERT INTO 表名
    VALUES(100,'str1','str2','str3',2,'2222',NULL);

上面这种插入高度依赖于表中列的定义次序，下面做出优化

    INSERT INTO 表名(列名1,列名2,列名3,列名4,列名5,列名6,列名7)
    VALUES (100,'str1','str2','str3',2,'2222',NULL);

下面这句的优点是，即使表的结构改变，这条语句仍然能正常工作。在插入时，应该使用下面的方式进行插入。

需要注意的是，不能插入同一条数据两次。

### 插入部分行

假设一个表一共有7列，则可以插入部分行

    INSERT INTO 表名(列名1,列名2,列名3,列名4,列名5)
    VALUES (100,'str1','str2','str3',2);

插入部分行需要满足下面的某个条件
- 省略的列允许定义为空值`NULL`；
- 在表定义中给出默认值，表示如果不给出值，将使用默认值。

### 插入检索出的数据

将`SELECT`出来的结果插入到表中。

    INSERT INTO 表名1(列名1,列名2,列名3,列名4,列名5,列名6,列名7)
    SELECT 列名1,列名2,列名3,列名4,列名5,列名6,列名7
    FROM 表名2

其中，`表1`和`表2`的结构应该一致，`INSERT SELECT`语句中`SELECT`可以包含`WHERE`子句，以过滤插入的数据。`INSERT SELECT`语句中，不一定要求列名匹配，`SELECT`中的第一列用来填充表列中指定的第一列，第二列用来填充表列中指定的第二列。

`INSERT`只插入一行，如果插入多行需要多个`INSERT`语句，`INSERT SELECT`可以插入多行。


## 从一个表复制到另一个表

`INSERT SELECT`将数据添加到一个已经存在的表中，`CREATE SELECT`将数据复制到一个新的表中。

下面创建一个新`表1`，并把`表2`的整个内容复制到新表中。

    CREATE TABLE AS 表名1 SELECT * FROM 表名2;

使用`SQL Server`的同义写法：

    SELECT * INTO 表名1 FROM 表名2

# 更新和删除数据

## 更新数据

### 更新某一列

`UPDATE`以更新的表名开始，使用`SET`将新值赋给被更新的列。

    UPDATE 表名
    SET 列名1 = 'str1'
    WHERE 列名2 = 10000;

如果没有`WHERE`子句，则会更新表中的所有行

### 更新多个列

    UPDATE 表名
    SET 列名1 = 'str1',
        列名2 = 'str2'
    WHERE 列名2 = 10000;

### 删除某列

将该列的值设置为`NULL`。

    UPDATE 表名
    SET 列名1 = NULL
    WHERE 列名2 = 10000;

## 删除数据

使用`DELETE`语句，包括删除特定行和删除所有行。

删除特定行

    DELETE FROM 表名
    WHERE 列名1 = 10000;

若不指定`WHERE`，则删除了所有的行。

`DELETE`不需要列名或者通配符，删除的是整行而不是删除列。如果需要删除列，则需要使用`UPDATE`语句。

## 更新和删除的原则

- 除非确实打算更新和删除每一行，否则必须要使用`WHERE`子句；
- 保证每个表都有主键，尽可能像`WHERE`子句那样使用它；
- 在`UPDATE`和`DELETE`语句使用`WHERE`子句之前，应该先使用`SELECT`语句测试，保证过滤的是正确的记录。